# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫

## üö® –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°–∏–º–ø—Ç–æ–º—ã
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è "–°–ª–µ–¥—É—é—â–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ X –º–∏–Ω."
- –ù–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç
- –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π "–í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏! –ó–∞–ø—É—Å–∫–∞—é auto_post_cycle‚Ä¶"

### –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

#### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã
```bash
python debug_autoposting.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚ùå –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
- üìä –ü–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã

#### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
python fix_autoposting.py
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –í–∫–ª—é—á–∏—Ç –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏—é –≤ Telegram
- –í–∫–ª—é—á–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–ø–æ—Å—Ç–æ–≤

#### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
# –í Docker
docker-compose restart
# –ò–ª–∏ —Ç–æ–ª—å–∫–æ –±–æ—Ç
docker-compose restart bot
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º

#### ‚ùå –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –≤—ã–∫–ª—é—á–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞:** `auto_mode_status: off` –∏–ª–∏ `auto_posting_enabled: 0`

**–†–µ—à–µ–Ω–∏–µ:**
```python
await update_setting('auto_mode_status', 'on')
await update_setting('auto_posting_enabled', '1')
```

#### ‚ùå –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** `publish_to_tg: False` –∏ `publish_to_vk: False`

**–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é:
```python
publishing_manager = PublishingManager()
await publishing_manager.update_settings(
    user_id=int(ADMIN_ID),
    publish_to_tg=True
)
```

#### ‚ùå –ü—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–º –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ–º—ã —á–µ—Ä–µ–∑ –º–µ–Ω—é "–ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω"

#### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–º–ø—Ç—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã —á–µ—Ä–µ–∑ –º–µ–Ω—é "–ü—Ä–æ–º–ø—Ç—ã"

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```python
from database.settings_db import get_setting

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
auto_mode = await get_setting("auto_mode_status", "off")
auto_enabled = await get_setting("auto_posting_enabled", "0")
interval = await get_setting("post_interval_minutes", "240")

print(f"–ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥: {auto_mode}")
print(f"–ê–∫—Ç–∏–≤–µ–Ω: {auto_enabled}")
print(f"–ò–Ω—Ç–µ—Ä–≤–∞–ª: {interval} –º–∏–Ω")
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å—Ç–∞
```python
from database.posts_db import get_last_post_time
from datetime import datetime, timedelta

last_time = await get_last_post_time()
if last_time:
    interval_min = int(await get_setting("post_interval_minutes", "240"))
    next_time = last_time + timedelta(minutes=interval_min)
    now = datetime.now()
    
    if next_time <= now:
        print("‚ö†Ô∏è –ì–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏!")
    else:
        diff = next_time - now
        print(f"‚è∞ –î–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: {diff}")
```

### –õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### –£—Å–ø–µ—à–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞:
```
INFO:root:–°–ª–µ–¥—É—é—â–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ X.X –º–∏–Ω.
INFO:root:–í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏! –ó–∞–ø—É—Å–∫–∞—é auto_post_cycle‚Ä¶
INFO:[Auto-Post] –ù–æ–≤—ã–π —Ü–∏–∫–ª.
INFO:[Auto-Post] –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω...
INFO:[Auto-Post] –ù–∞–π–¥–µ–Ω–∞ —Ç–µ–º–∞: ID=X, theme='...', category='...'
INFO:[Auto-Post] –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ—Å—Ç –¥–ª—è —Ç–µ–º—ã: ...
INFO:[Publisher] –ù–∞—á–∞–ª–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞ –Ω–∞ —Ç–µ–º—É: ...
INFO:[Publisher] –ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ Telegram.
```

#### –ü—Ä–æ–±–ª–µ–º—ã:
- –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è "–í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏!" ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ä–∞—Å—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è "–ù–æ–≤—ã–π —Ü–∏–∫–ª" ‚Üí –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è auto_post_cycle
- –û—à–∏–±–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å AI —Å–µ—Ä–≤–∏—Å–æ–º –∏–ª–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
- –û—à–∏–±–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º

### –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. **–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞:**
```python
await update_setting('auto_mode_status', 'off')
await update_setting('auto_posting_enabled', '0')
# –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É
await update_setting('auto_mode_status', 'on')
await update_setting('auto_posting_enabled', '1')
```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:**
```bash
docker-compose restart
```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:**
```bash
docker-compose logs -f --tail=50
```

## üîß –î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep python
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
docker-compose down
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d
```

### –û—à–∏–±–∫–∏ AI —Å–µ—Ä–≤–∏—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω—ã API –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏ OpenRouter –≤ .env —Ñ–∞–π–ª–µ

### –ü—Ä–æ–±–ª–µ–º—ã —Å VK
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω VK API
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –≥—Ä—É–ø–ø–µ
- VK –º–æ–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã 